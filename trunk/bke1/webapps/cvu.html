<html>
<head>
	<link rel="stylesheet" href="css/demos.css" media="screen" type="text/css">
	<script type="text/javascript">
	</script>
	<script type="text/javascript" src="js/editInfo.js"></script>
	<style type="text/css">
	body{
		margin:0px;
		font-size:0.8em;
	}
	#mainContainer{
		width:840px;
		margin:5px;
	}
	table,tr,td{
		vertical-align:top;
	}
	.textInput{
		width:300px;
	}
	html{
		margin:0px;
	}
	.formButton{
		width:75px;
	}
	textarea,input,select{
		font-family:Trebuchet MS;
	}
	i{
		font-size:0.9em;
	}
	</style>
	<script type="text/javascript">


	var aa1;
	var formName;
	var commentHiddenVar;
	var commentHiddenVar1;
	var aaa1="1";
	var vCommCID=33;
	var iCommCID=52;
	var aCommCID=85;
	var agentCommCID=49;
	
	
	
	var voucherTableId = "bdyvk9utc";
	var invoiceTableId = "bdyvk9utd";
	var allocationTableId = "bdyvk9ute";
	var agentTableId = "bdyvk9utf";
	
	
	function saveThis(){

	//alert(aa1);
	         commentHiddenVar.value=document.getElementById('comments').value;
	//alert(commentHiddenVar.name+' >> '+commentHiddenVar.value);

	
	var commentButtonVar =  eval("self.opener.document."+formName+"."+aa1+"b");

	//alert(commentButtonVar.name+' >> '+commentButtonVar.value);

  var objValue = document.getElementById('comments').value;
 // alert('objValue '+objValue);
 		if(objValue.length > 0){
 	//alert('3 ');
 			  //alert(aa1);
 						if((aa1=="voucherComm")){
 								//alert("voucherComm");
 								var voucherId = eval("self.opener.document."+formName+".voucherId.value"); 
        				//alert('voucher ID '+voucherId+' objvalue '+objValue);
        				//editValue(objValue,vCommCID,voucherTableId,voucherId);
        		   	editValue(objValue,vCommCID,voucherTableId,voucherId);
        		} else if( (aa1.indexOf('invoiceComm',0)!=-1) ){
 								//alert("invoiceComm");
 								
 								var currentInvoiceCountVar = eval("self.opener.document."+formName+".currentInvoiceCount"); 
 								var currentInvoiceCount = currentInvoiceCountVar.value; 
 							
 								//alert("currentInvoiceCount  "+currentInvoiceCount+"formName  "+formName);
 								
 								
 								var invoiceIdVar = eval("self.opener.document."+formName+".invoiceId"+currentInvoiceCount);
 								//alert(invoiceIdVar.name+invoiceIdVar.value)
 								var invoiceId = invoiceIdVar.value;
 								//eval("self.opener.document."+formName+".invoiceId"+currentInvoiceCount+".value");
 								 
        				//alert('invoiceId  '+invoiceId+' objvalue '+objValue);
        				//editValue(objValue,vCommCID,voucherTableId,voucherId);
        		  		
        		   		editValue(objValue,iCommCID,invoiceTableId,invoiceId);
        		   	        		  
        		  
        		   	
        		   	//alert('After Editing Invoice');
        		} else if( (aa1.indexOf('allocationComm',0)!=-1) ){
 										//alert("allocationComm");
 										var currentInvoiceCount = eval("self.opener.document."+formName+".currentInvoiceCount.value"); 
 										var currentAllocationCount = eval("self.opener.document."+formName+".currentAllocationCount.value"); 
 										//alert("currentInvoiceCount  "+currentInvoiceCount+"   currentAllocationCount "+currentAllocationCount);
 								
 										//error msg says allocationId is null or not an object. i changed using invoice
 										var allocationId = eval("self.opener.document."+formName+".allocationId"+currentInvoiceCount+"l"+currentAllocationCount+".value"); 
																	        				
      							//var allocationId = eval("self.opener.document."+formName+".invoiceId"+currentInvoiceCount+".value"); 			
        				//alert('invoiceId  '+allocationId+' objvalue '+objValue);
        						//editValue(objValue,vCommCID,voucherTableId,voucherId);
        		   	//alert('after alloc in comment html');
        		   		if(allocationId!="III") {
        		   					//alert('1 in comment html ');
        		   							editValue(objValue,aCommCID,allocationTableId,allocationId);
        		   		}else{
        		   						//alert('2 in comment html');
        		   						//commentButtonVar.style.backgroundColor='white';
        		   		
 													commentButtonVar.src='/docorganiz5/images/notes.png';
 	
    //    		   		window.close();
        		   		}
        		   	//alert('After Editing Invoice');
        		}else if( (aa1.indexOf('cmt',0)!=-1) ){
 								//alert("Agent Comm");
 								var currentAgentCount = eval("self.opener.document."+formName+".currentAgentCount.value"); 
 								//alert("currentAgentCount  "+currentAgentCount);
 								
 								var agentId = eval("self.opener.document."+formName+".agentId"+currentAgentCount+".value"); 
        				//alert('agentId  '+agentId+' objvalue '+objValue);
        				//editValue(objValue,vCommCID,voucherTableId,voucherId);
        		   	if(agentId!="III") {
        		   		editValue(objValue,agentCommCID,agentTableId,agentId);
        		   	}else{
        		   		//commentButtonVar.style.backgroundColor='white';
        		   		
 									commentButtonVar.src='/docorganiz5/images/notes.png';
 	
        		   		window.close();
        		   	}
        		   	//alert('After Editing Invoice');
        		}    
 	//			alert('4 ');
 	//		}
 	commentButtonVar.src='/docorganiz5/images/notes1.png';
 //alert(' commentButtonVar.src >> '+commentButtonVar.src);
	//			commentButtonVar.style.backgroundColor='green';
	//	}else if( (objValue.length == 0)&&(document.getElementById('com').value.length == 0) ){
		}else {
				//alert('else 5 ');
 				//commentButtonVar.style.backgroundColor='white';
 				
 	commentButtonVar.src='/docorganiz5/images/notes.png';
	  }
	window.close();
  }
  
  function closeThis(){
  			if (window.focus) window.close();
  	}
  
/*
	function closeThis(){
		if (window.focus) {comentwindow.focus()}
	}
*/	
	function focus(){


 								
 								
			 formName = self.opener.document.forms[0].name;
			 
			 aa1 = eval("self.opener.document."+formName+".comm.value");
			 if(aa1.value==undefined){
			 	aa1.value="";
			 }	
			 //aa1=self.opener.document.voucherInvoiceAllocation.comm.value;
			 //alert(opener.name)
			 commentHiddenVar =  eval("self.opener.document."+formName+"."+aa1);
			 //alert(commentHiddenVar.name);
			 commentHiddenVar1 =  eval("self.opener.document."+formName+"."+aa1+"h");
			 //alert(commentHiddenVar1.name);
     
     
     
  	if(commentHiddenVar.value==null){
			//alert("Inside If value  "+commentHiddenVar.value);
  	 	commentHiddenVar.value="";
  	}

     document.getElementById('comments').value = commentHiddenVar.value;




	//alert(commentHiddenVar1.value);
	if((commentHiddenVar1!=null)&&(commentHiddenVar1.value.length > 0)){
		//alert(commentHiddenVar1.value);
		document.getElementById('com1').innerHTML=commentHiddenVar1.value;
		document.getElementById('com').value=commentHiddenVar1.value;

	}

	}

	</script>
</head>
<body onload="focus();">
	<span id="errorMessage">
<div id="mainContainer">
	<fieldset>
	<form method="post" name="commentForm">
			 <table cellspacing="2" cellpadding="2" width="350" height="100%" bgcolor="#ffffff" >
				<tr valign="top">
					
					<td><span id="com1"><p wrap='true'></p></span><input type="hidden" id="com" name="com" ></td>
					<input type=hidden id=comments name=comments >
				</tr>
				<tr>
					<td>
						<button  class="tbutton" name="closeComment" id="closeComment" onclick="closeThis();">Return</button>
					</td>
				</tr>
			 </table>
	</form>
</fieldset>
</div>
</body>
</html>
