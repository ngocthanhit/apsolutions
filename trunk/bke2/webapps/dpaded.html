<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Content-Type" content="text/html">
	<title>Charge Detail</title>
	<link rel="stylesheet" href="css/demos.css" media="screen" type="text/css">
	<style type="text/css">
		table {
			font-family: Trebuchet MS, Lucida Sans Unicode, Arial, sans-serif;
			font-size:0.9em;
			margin:1px;
		}
		button  {
			font-family: Trebuchet MS, Lucida Sans Unicode, Arial, sans-serif;
			font-size:0.72em;
			font-weight:bold;
		}
	span.rqrd		{ color:red; font-weight:bold; margin-right:5px};
	</style>
	<script type="text/javascript" src="js/actb.js"></script>
 	<script type="text/javascript" src="js/editInfo.js"></script>
	<script type="text/javascript" src="js/addInfo.js"></script>
	<script type="text/javascript" src="js/validateTableComplete.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript">



	
	var depArray = new Array(12);
  	depArray[0] ='AC';
	depArray[1] ='BE';
	depArray[2] ='BS';
	depArray[3] ='CC';
	depArray[4] ='CS';
	depArray[5] ='IS';
	depArray[6] ='LG';
	depArray[7] ='LS';
	depArray[8] ='MK';
	depArray[9] ='OF';
	depArray[10] ='PM';
	depArray[11] ='TR';



	function setDep(sv1){
	        var oo3 = actb(sv1,depArray);
			 oo3.actb_lim = 5;
			 oo3.actb_firstText = true;
			 oo3.actb_mouse = true;

		  }


	var aId=2;


 function deleteRow()
    {

//Logic would check where ever there is a check box
//search for all checks
//for each check call deleteInfo
//on successfull delete then remove from UI

	}

 function insertAgentRow()
    {
	var inc = document.getElementById('agnCtr').value
	//alert('InvoiceCount '+inc)
	inc++
	//alert('InvoiceCount '+inc)


    var x=document.getElementById('AgentTable').insertRow(inc)
    x.valign="top"
  	var x0=x.insertCell(0)
    x0.align="center"
    x0.width="10%"
 		x0.innerHTML="<td><input type='hidden' name='agentId"+inc+"' value='III' id='agentId"+inc+"'><input name='empId"+inc+"' id='empId"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue';setEmpId(document.getElementById('empId"+inc+"'))  onBlur=fillOther(this,"+inc+");this.style.backgroundColor='White'; class='inps'   size='8'></td>"   
    var x1=x.insertCell(1)
    x1.align="center"
    x1.width="20%"
  	x1.innerHTML="<td><input name='empName"+inc+"' id='empName"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue';setEmpName(document.getElementById('empName"+inc+"'))  onBlur=fillOther(this,"+inc+");this.style.backgroundColor='White'; class='inps'   size='16'></td>"
	  var x2=x.insertCell(2)
    x2.align="center"
    x2.width="30%"
  	x2.innerHTML="<td><input name='labCat"+inc+"' id='labCat"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue';setLabCat(this);  onBlur=fillOther(this,"+inc+");this.style.backgroundColor='White'; class='inps'   size='5' maxlength='5'></td>"
    var x3=x.insertCell(3)
    x3.align="center"
    x3.width="10%"
  	x3.innerHTML="<td><input name='labDesc"+inc+"' id='labDesc"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue';setLabCat(this);  onBlur=fillOther(this,"+inc+");this.style.backgroundColor='White'; class='inps'   size='12' maxlength='12'></td>"
    var x4=x.insertCell(4)
    x4.align="center"
    x4.width="10%"
		x4.innerHTML="<td><input name='hours"+inc+"' id='hours"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue'; onBlur=this.style.backgroundColor='White'; class='inps'  size='2' ></td>"
    var x5=x.insertCell(5)
    x5.align="center"
    x5.width="10%"
	  x5.innerHTML="<td><input style='text-align : right;' name='agent_amount"+inc+"' id='agent_amount"+inc+"' onfocus=setCount("+inc+");this.style.backgroundColor='SkyBlue';  onBlur=agentAmtChange(this);agentAmtBlur(this,"+inc+");transAmountBlur(this,"+inc+"); class='inps'  size='18' maxlength='18'></td>"
	  var x6=x.insertCell(6)
    x6.align="center"
    x6.width="10%"
		x6.innerHTML="<IMG id='cmt"+inc+"b' style='align: right;' height=24  alt=''  onclick=commentWindow('Comment.html','cmt"+inc+"');  onselect='commentWindow('Comment.html','cmt"+inc+"')' src='/docorganiz5/images/notes.png' width=20 border=1><input   type='hidden' name='cmt"+inc+"h' id='cmt"+inc+"h' ></input><input type='hidden' name='cmt"+inc+"' id='cmt"+inc+"' ></input>";
	
  document.getElementById('agnCtr').value=inc;
	 document.getElementById('empId'+inc).focus();
}

function save(){

//alert('inside save for '+aa1);
///         var subtotalVar =  eval("self.opener.document.voucherInvoiceAllocation.sub_tot"+aa1)
//alert('subtotalVar.name '+subtotalVar.name);         

///alert('agentTot value is ' + document.getElementById('agentTot').value);
////         subtotalVar.value=document.getElementById('agentTot').value
         
         self.opener.document.voucherInvoiceAllocation.fromAwindo.value='true'


         var len = document.getElementById('agnCtr').value

		 var empIdArray="";
		 var empNameArray="";
		 var labCatArray="";
		 var labDescArray="";
		 var agentNoArray="";
		 var agentIdArray="";
		 var agentAmtArray="";
		 var hoursArray="";
		 var agentActArray="";
		 var agentChgArray="";
		 var agentDepArray="";
		 var agentCommArray="";

		 var hasValue='false';

  	for(var i=1; i<=len;i++){

			 //alert('IN loop i >>>'+document.getElementById('agentId'+i).value+'<<<< ' );

			  if(document.getElementById('labCat'+i).value.length==0){
			  break;
			  }	else {hasValue='true';}

			  agentIdArray = agentIdArray+"&"+document.getElementById('agentId'+i).value
			  
//alert('agentIdArray >> '+agentIdArray);

			  empIdArray = empIdArray+"&"+document.getElementById('empId'+i).value
			  
//alert('empIdArray >> '+empIdArray);
				empNameArray = empNameArray+"&"+document.getElementById('empName'+i).value
			  labCatArray = labCatArray+"&"+document.getElementById('labCat'+i).value
			  labDescArray = labDescArray+"&"+document.getElementById('labDesc'+i).value
  			hoursArray = hoursArray+"&"+document.getElementById('hours'+i).value
	  		
	  		tmp = document.getElementById('agent_amount'+i).value;
			  tmp = filterNum(tmp)
			   //alert('amout  '+tmp)
	  		agentAmtArray =  agentAmtArray+"&"+tmp




//alert('3');
			  		var a0 =eval("self.opener.document.voucherInvoiceAllocation.agentId"+aa1)
			  		a0.value=agentIdArray
//alert('3');
			  		var a1 =eval("self.opener.document.voucherInvoiceAllocation.empId"+aa1)
			  		a1.value=empIdArray
//alert('3a');			  		
			  		var a2 =eval("self.opener.document.voucherInvoiceAllocation.empName"+aa1)
			  		a2.value=empNameArray
//alert('3a');			  		
			  		var a3 =eval("self.opener.document.voucherInvoiceAllocation.labCat"+aa1)
			  		a3.value=labCatArray
//alert('3a');			  		
			  		var a4 =eval("self.opener.document.voucherInvoiceAllocation.labDesc"+aa1)
			  		a4.value=labDescArray
//alert('3a');			  		
			  		var a5 =eval("self.opener.document.voucherInvoiceAllocation.hours"+aa1)
			  		a5.value=hoursArray
//alert('3a');			  		
			  		var a6 =eval("self.opener.document.voucherInvoiceAllocation.agent_amount"+aa1)
			  		a6.value=agentAmtArray

	  		  if(document.getElementById('cmt'+i).value.length>0){
	  		  	agentCommArray =  agentCommArray+"&"+document.getElementById('cmt'+i+'h').value+"&"+document.getElementById('cmt'+i).value;
	  		  }else{
	  		  	agentCommArray =  agentCommArray+"&"+document.getElementById('cmt'+i+'h').value;	  		  	
	  		  }
	  		  //agentCommArray =  agentCommArray+"&"+document.getElementById('cmt'+i).value

  		}


///alert('empNameArray '+empNameArray);
											//alert(document.getElementById("agentTot").value);
/*
					var subTot = eval("self.opener.document.voucherInvoiceAllocation.sub_tot"+aa1)
					var subTotal = eval("self.opener.document.voucherInvoiceAllocation.sub_total"+aa1)
					var allocButton =eval("self.opener.document.voucherInvoiceAllocation.addAllocation"+bb1);
					allocButton.focus();
*/
			var addAgentObj =eval("self.opener.document.voucherInvoiceAllocation.addAgent"+aa1);
			
		  if(empIdArray.length > 2 ){
	  	
 													addAgentObj.src='/docorganiz5/images/popup1.png';
	  	}

//alert('5');
         window.close();


}


    function cancelAndReturn(){
				 //if (!comentwindow.closed && comentwindow.location) 
					//comentwindow.close();
        
        window.close();
    }

    
	var comentwindow;
	function commentWindow(url,hiddenName)
	{
		document.getElementById('comm').value = hiddenName
		comentwindow=window.open(url,'Comment','scrollbars=no,status=no,height=200,width=450');
		if (window.focus) {comentwindow.focus()}
	}

	var vendor_id ="";
	var vendor_name="";
	var approval_status="";
	var voucher_no="";

  var purchaseAmt;

	
	var allocPK = "";
	var aa1;
	var bb1;



	
	function setEmpId(sv1){
		//alert(sv1.name)
	     var oo1 = actb(sv1,empIdLookupArray);
			 oo1.actb_lim = 5;
			 oo1.actb_firstText = true;
			 oo1.actb_mouse = true;
		  }

	
	function setEmpName(sv1){
	     var oo1 = actb(sv1,empNameLookupArray);
			 oo1.actb_lim = 5;
			 oo1.actb_firstText = true;
			 oo1.actb_mouse = true;
		  }
function setLabCat(sv1){
	     var oo1 = actb(sv1,labCatLookupArray);
			 oo1.actb_lim = 5;
			 oo1.actb_firstText = true;
			 oo1.actb_mouse = true;
		  }
function setLabDesc(sv1){
	     var oo1 = actb(sv1,labDescLookupArray);
			 oo1.actb_lim = 5;
			 oo1.actb_firstText = true;
			 oo1.actb_mouse = true;
		  }


	function fillOther(svn,aa)
	{
		//alert('aa '+aa);

		//alert('FillOther '+svn.name);
		if (svn.name == 'empId'+aa){
        for(var i=1; i<= empIdLookupArray.length-1 ;i++){
					if (empIdLookupArray[i] == svn.value){
        	   	document.getElementById('empName'+aa).value=empNameLookupArray[i];
  						}
					}
	
		}else if (svn.name == 'empName'+aa){
    	   for(var i=1; i<= empNameLookupArray.length-1 ;i++){
						if (empNameLookupArray[i] == svn.value){
           	   	document.getElementById('empId'+aa).value=empIdLookupArray[i];
           	}						 								
					}
		}else if (svn.name == 'labCat'+aa){
    	   for(var i=1; i<= labCatLookupArray.length-1 ;i++){
						if (labCatLookupArray[i] == svn.value){
           	   	document.getElementById('labDesc'+aa).value=labDescLookupArray[i];
           	}						 								
					}
		}else if (svn.name == 'labDesc'+aa){
    	   for(var i=1; i<= labDescLookupArray.length-1 ;i++){
						if (labDescLookupArray[i] == svn.value){
           	   	document.getElementById('labCat'+aa).value=labCatLookupArray[i];
           	}						 								
					}
		}
	
	
	
}
		
  var empIdLookupArray = "";
  var empNameLookupArray = "";
  var labCatLookupArray = "";
  var labDescLookupArray = "";
  

	var agent_amountArray=new Array();
	var empIdArray=new Array();	
	var empNameArray=new Array();
	var labDescArray=new Array();
	var labCatArray=new Array();
	var hoursArray=new Array();
	var agentCommArray=new Array();
	var agentIdArray=new Array();
	
	
	var agent_amountStr="";
	var empIdStr="";	
	var empNameStr="";
	var labDescStr="";
	var labCatStr="";
	var hoursStr="";
	var agentCommStr="";
	var agentIdStr="";
	
	function focus(){


	aa1=self.opener.document.voucherInvoiceAllocation.aa1.value;
	bb1=self.opener.document.voucherInvoiceAllocation.bb1.value;


///alert('aa1  '+aa1+' bb1 '+bb1);
		 document.getElementById('empId1').focus();
			
/*			var fromAwindowFocusObject = eval("self.opener.document.voucherInvoiceAllocation.fromAwindowFocus");
			if(fromAwindowFocusObject.value=='0'){
				fromAwindowFocusObject.value='1';			
			}			
 */

		 	 allocPK = eval("self.opener.document.voucherInvoiceAllocation.allocationId"+aa1).value;

///			alert('Allocation allocPK >> '+allocPK);
			 vendor_id=self.opener.document.voucherInvoiceAllocation.vendor_id.value
			 vendor_name=self.opener.document.voucherInvoiceAllocation.vendor_name.value
			 approval_status=self.opener.document.voucherInvoiceAllocation.process_status.value
			 voucher_no=self.opener.document.voucherInvoiceAllocation.voucher_no.value
			 var purchaseAmt1 =  eval("self.opener.document.voucherInvoiceAllocation.purchase_amt"+aa1)
			 //alert('Loading time purchaseAmt '+purchaseAmt1)
			 purchaseAmt =  filterNum(purchaseAmt1.value);
			// alert('After filtering purchaseAmt '+purchaseAmt)







			//Parse drop downs

		     empIdLookupArray = eval("self.opener.document.voucherInvoiceAllocation.empId").value.split('&');
		     empNameLookupArray = eval("self.opener.document.voucherInvoiceAllocation.empName").value.split('&');
		     labCatLookupArray = eval("self.opener.document.voucherInvoiceAllocation.labCat").value.split('&');
		     labDescLookupArray=eval("self.opener.document.voucherInvoiceAllocation.labDesc").value.split('&');
		     			
			
			//Parse detailCode arrays

/*
		     agentIdArray = eval("self.opener.document.voucherInvoiceAllocation.agentId"+aa1).value.split('&');
		     agentNoArray = eval("self.opener.document.voucherInvoiceAllocation.agent_number"+aa1).value.split('&');
		     agentAmtArray=eval("self.opener.document.voucherInvoiceAllocation.agent_amount"+aa1).value.split('&');
		     agentActArray=eval("self.opener.document.voucherInvoiceAllocation.account"+aa1).value.split('&');
		     agentChgArray=eval("self.opener.document.voucherInvoiceAllocation.charge_code"+aa1).value.split('&');
		     agentDepArray=eval("self.opener.document.voucherInvoiceAllocation.dep_code"+aa1).value.split('&');
		     
*/


		     agentIdStr = eval("self.opener.document.voucherInvoiceAllocation.agentId"+aa1);
		     empIdStr = eval("self.opener.document.voucherInvoiceAllocation.empId"+aa1);
		     empNameStr = eval("self.opener.document.voucherInvoiceAllocation.empName"+aa1);
		     labCatStr=eval("self.opener.document.voucherInvoiceAllocation.labCat"+aa1);
		     labDescStr=eval("self.opener.document.voucherInvoiceAllocation.labDesc"+aa1);
		     hoursStr=eval("self.opener.document.voucherInvoiceAllocation.hours"+aa1);
		     agent_amountStr=eval("self.opener.document.voucherInvoiceAllocation.agent_amount"+aa1);

	
///				 alert('agentIdStr   --> '+agentIdStr.value);

	
				 if(agentCommTemp==null){
		   	 	//return;
		   	 }//else
	
		   	 if( (agentIdStr!=null) && (agentIdStr.value.length>1) ){
		     	agentIdArray=agentIdStr.value.split('&');
		     	empIdArray=empIdStr.value.split('&');
		     	empNameArray=empNameStr.value.split('&');
		     	labCatArray=labCatStr.value.split('&');
		     	labDescArray=labDescStr.value.split('&');
		     	hoursArray=hoursStr.value.split('&');
		     	agent_amountArray=agent_amountStr.value.split('&');
			   }

///			 alert('agentIdArray   --> '+agentIdArray);

	
		   	 var agentCommTemp = eval("self.opener.document.voucherInvoiceAllocation.agentComm"+aa1);
		   	 	 //alert('agentCommTemp   --> '+agentCommTemp);
		   	 if( (agentCommTemp!=null) && (agentCommTemp.value.length>1) ){
		     	agentCommArray=agentCommTemp.value.split('&');
		   	 	 //alert('agentCommArray   --> '+agentCommArray);
			   }
	
		     
		     
			//	 alert('agentCommArray   --> '+agentCommArray);

///	 			alert('Number of Detail records available  --> '+empIdArray.length+' empIdArray is '+empIdArray);

		     for(var i=1; i<(empIdArray.length);i++){

		     	insertAgentRow();

		     	document.getElementById('agentId'+i).value=agentIdArray[i];
		     	document.getElementById('empId'+i).value=empIdArray[i];
		     	document.getElementById('empName'+i).value=empNameArray[i];
		     	document.getElementById('labCat'+i).value=labCatArray[i];
		     	document.getElementById('labDesc'+i).value=labDescArray[i];
		     	document.getElementById('hours'+i).value=hoursArray[i];
		     	document.getElementById('agent_amount'+i).value=agent_amountArray[i];
		     	
		     	if(agentCommArray[i]!=null){
		     		//alert(' agentCommArray[i]   --> '+agentCommArray[i]);		     		
						document.getElementById('cmt'+i+'b').src='/docorganiz5/images/notes1.png';
		     	  document.getElementById('cmt'+i+'h').value=agentCommArray[i];
					}
					
		     	if(agentCommArray[i]==null){
		     		//alert(' agentCommArray[i]   --> '+agentCommArray[i]);		     		
						document.getElementById('cmt'+i+'b').src='/docorganiz5/images/notes.png';
		     	  document.getElementById('cmt'+i+'h').value="";
					}
					

 	
		     }

			//alert('Length morethan 0 '+document.getElementById('agent_number1').value.length)
			 if(document.getElementById('agentId1').value.length!=0)
			 tally()
			//window.focus();
			//return false;
	}

		     
		     
	document.onkeydown = function(){
//alert('key pressed');
var currentAgentCount = document.getElementById('currentAgentCount').value;

//alert('currentAgentCount'+currentAgentCount);

//trapCtrlKeyCombination(event);
 		//F2
                if(window.event && window.event.keyCode == 113)
                { // Capture and remap F2
                        window.event.keyCode = 501;
                }
                if(window.event && window.event.keyCode == 501)
                {
                        //alert('F2 key was pressed');
                        //document.getElementById('addIinvoice').click();
                        return false;
                }


//alert('Key pressed '+ window.event.keyCode);
		//F3 Key
        if(window.event && window.event.keyCode == 114)
                { // Capture and remap F3
        	window.event.keyCode = 503;
          	}

        if(window.event && window.event.keyCode == 503)
        {
        	//alert('F3 key was pressed');
        	//document.getElementById('addAgentChg').click();
	        document.getElementById('cmt'+currentAgentCount+'b').focus();
 					document.getElementById('cmt'+currentAgentCount+'b').click();	
        	return false;
        }

        //F4 Key
        if(window.event && window.event.keyCode == 115)
                { // Capture and remap F4
                window.event.keyCode = 504;
                }
 
        if(window.event && window.event.keyCode == 504)
                {
                //alert('F4 key was pressed');
                //document.getElementById('addAgentChg').click();
		//document.getElementById('dep_code'+currentAgentCount).blur();
                //document.getElementById('addAgentChg').focus();
                document.getElementById('addAgentChg').click();
		//insertAgentRow(); 		
		 //document.getElementById('agent_number'+currentAgentCount).focus();
		
                return false;
                }
		//F5
                if(window.event && window.event.keyCode == 116)
                { // Capture and remap F5
                        window.event.keyCode = 504;
                }
                if(window.event && window.event.keyCode == 504)
                {
                        //alert('F5 key was pressed');
                       // document.getElementById('addInvoice').click();
                        return false;
                }

		//F6
        	if(window.event && window.event.keyCode == 117)
                { // Capture and remap F6
        		window.event.keyCode = 506;
  
        	}

        	if(window.event && window.event.keyCode == 506)
                {
        	//alert('F6 key was pressed');
        		document.getElementById('saveDone').focus();
						//document.getElementById('saveDone').click();
						save();	
        		return false;
        	}
  
 		//F7
                if(window.event && window.event.keyCode == 118)
                { // Capture and remap F7
                        window.event.keyCode = 507;
                }
 
                if(window.event && window.event.keyCode == 507)
                {
                        //alert('F7 key was pressed');
                        //document.getElementById('addAgentChg').click();
                        return false;
                }
                //F8
                if(window.event && window.event.keyCode == 119)
                { // Capture and remap F8
                        window.event.keyCode = 508;
                }
                if(window.event && window.event.keyCode == 508)
                {
                        //alert('F8 key was pressed');
                        //document.getElementById('addImage').click();
                        return false;
                }

	//F9
        if(window.event && window.event.keyCode == 120)
                { // Capture and remap F5
                window.event.keyCode = 509;
                }
 
        if(window.event && window.event.keyCode == 509)
                {
                //alert('F9 key was pressed');
		document.getElementById('saveDone').focus();
                cancelAndReturn();
		//document.getElementById('saveDone').click();
                return false;
                }



	}

 
	function toCash(p, c, t, d) {

		var s = (0 > p) ? "-" : ""
		var m = String(Math.round(Math.abs(p*100)))

		var j, k = "", f
		c = c || "" ; t = t || "" ; d = d || "."
		c="$"
		t=','
		while (m.length < 3) m = "0" + m

		f = m.substring((j = m.length - 2))
		while (j > 3) { k = t + m.substring(j - 3, j) + k ; j -= 3 }
		k = m.substring(0, j) + k
		return s + c + k + d + f
	}

	function TryCash(S) {
		S = filterNum(S)
		var T = S.split(/\s+/)
		return toCash(+T[0], T[1], T[2], T[3])

	}

	function tocash(X) { return toCash(X*100) }


	function filterNum(str) {
		re = /^\$|,/g;
		var temp = str.replace(re, "");
		temp = temp.replace("$", "");
		temp = temp.replace(",", "");
		return temp
	}

function tally()
    {
			var a=0;
			for(var i=1; i<=document.getElementById('agnCtr').value;i++){
			if(i==1) {
				a =0*1
			}

			a=filterNum(eval("document.getElementById('agent_amount"+i+"').value"))*1+a;

		}
		
	setResidualAmt(a);
	a=TryCash(a+'');

	//alert('Total'+a)
	document.getElementById("agentTot").value=a;
	document.getElementById("agentTotal").innerHTML=a;

}

function setResidualAmt(a){
//alert('Subtract this amount '+a)
//alert('purchaseAmt for this Allocation is '+purchaseAmt)

var residualAmt = purchaseAmt - a;
if(residualAmt<0)
	document.getElementById("residualAmount").style.backgroundColor='yellow';
if(residualAmt>=0)	document.getElementById("residualAmount").style.backgroundColor='white';

var currency_residualAmt=TryCash(residualAmt+'');
document.getElementById("residualAmount").innerHTML=currency_residualAmt;

}

function agentAmtChange(svr){

	var stat1='true';
	//Make AgentAmount Yellow
        if( (filterNum(svr.value)*1<=0) || (filterNum(svr.value)*1>purchaseAmt) ){
		  stat1='false';
		}
		if(isNaN(filterNum(svr.value))){
			 stat1='false';
		}


		if(stat1=='false'){
		  svr.style.backgroundColor='yellow';
		}else{
		  svr.style.backgroundColor='white';
		}

		svr.value=TryCash(svr.value);
		tally();
}

function validate(svr){
	//alert('inside validate');

	  var ff='false';

        
	  if(svr.name.indexOf('agent_number',0)!=-1)	{
		if((svr.value=='')||(svr.value.length<5))	ff='false'; else ff='true';
	  }
	  else if(svr.name.indexOf('agent_account',0)!=-1)	{
		if((svr.value=='')||(svr.value<=0))	ff='false'; else ff='true';
	  }
	  else if(svr.name.indexOf('account',0)!=-1)	{
	    if(svr.value=='')	ff='false';
		for (i in accountArray) {
		  if (accountArray[i] == svr.value) {
      	  ff='true'; break;}
        }
	  }
	  
	  else if(svr.name.indexOf('dep_code',0)!=-1)	{
	    if(svr.value=='')	ff='false';
		for (i in depArray) {
		  if (depArray[i] == svr.value) {
      	  ff='true'; break;}
        }
	  }


	  if(ff=='false'){
		 svr.style.backgroundColor='yellow';
	  }else{
	   	 svr.style.backgroundColor='white';
	  }




}

var agentTableId = 'bdyvk9utf';
var agentNumberCID = 9;
var empIdCID = 11;
var agentAmountCID = 10;
var accountCID = 35;
//var chargeCodeCID =11;
var depCID = 12;

function setCount(a1){
	//alert('setCOunt  '+a1);
	document.getElementById('currentAgentCount').value=a1;
}

function agentNumberBlur(obj1,a1){
       var agentIdVal = document.getElementById('agentId'+a1).value;
       // alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
        if( agentIdVal!="III" ){
	 //alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);       
         editValue(obj1.value,agentNumberCID,agentTableId,agentIdVal);
        }

}


function empIdBlur(obj1,a1){
       var agentIdVal = document.getElementById('agentId'+a1).value;
       // alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
        if( agentIdVal!="III" ){
	 //alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);       
         editValue(obj1.value,empIdCID,agentTableId,agentIdVal);
        }

}




function agentAmtBlur(obj1,a1){
       var agentIdVal = document.getElementById('agentId'+a1).value;
       // alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
        if( agentIdVal!="III" ){
         //alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
         editValue(obj1.value,agentAmountCID,agentTableId,agentIdVal);
        }
 
}

function accountBlur(obj1,a1){
       var agentIdVal = document.getElementById('agentId'+a1).value;
       // alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
        if( agentIdVal!="III" ){
         //alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
         editValue(obj1.value,accountCID,agentTableId,agentIdVal);
        }
 
}



function depBlur(obj1, a1){
	validate(obj1);
	//var obj1 = document.getElementById('dep_code'+a1);
	var agentIdVal = document.getElementById('agentId'+a1).value;
	var allocPK1 = eval("self.opener.document.voucherInvoiceAllocation.allocationId"+aa1).value;
	//alert('allocPK  '+allocPK1);

 	if( (agentIdVal=='III') && (isAgentComplete(a1)) ){
		addAgentValue('agent', a1, allocPK1)
 	}else  if( agentIdVal!="III" ){
         //alert('obj1.value '+ obj1.value+' agentIdVal '+agentIdVal);
         editValue(obj1.value,depCID,agentTableId,agentIdVal);
        }
	document.getElementById('addAgentChg').focus();
}
function transAmountBlur(obj1, a1){
	//validate(obj1);
	//var obj1 = document.getElementById('dep_code'+a1);
	var agentIdVal = document.getElementById('agentId'+a1).value;
	var allocPK1 = eval("self.opener.document.voucherInvoiceAllocation.allocationId"+aa1).value;
	//alert('allocPK  '+allocPK1);
	//isAgentComplete(a1);
	if( (agentIdVal=='III') && (isAgentComplete(a1)) ){
		addAgentValue('agent', a1, allocPK1);
 	 }
 	 obj1.style.backgroundColor='white';
	document.getElementById('addAgentChg').focus();
}




</script>
</head>

<body onLoad="focus();">
<form method="POST" action="dpaded.jsp" name="AgentForm">

<table class=vouch>
<tr>
<td width="80%" align="center" style="color:red" ><span id="errorMessage"></span></td>
</tr>



<tr>
	<td>
<table cellspacing="2" cellpadding="2" width="100%" bgcolor="#ffffff" border="1">
  <tr valign="top">
    <td width="87">Group ID :</td>
    <td width="136"><script>document.write(self.opener.document.voucherInvoiceAllocation.voucher_no1.value);</script></td>
	<td width="112">Status :</td>
    <td><script>document.write(self.opener.document.voucherInvoiceAllocation.process_status.value);</script></td>
  </tr>
  <tr valign="top">
    <td width="87">Vendor ID :</td>
    <td width="136"><script>document.write(self.opener.document.voucherInvoiceAllocation.vendor_id.value);</script></td>
  <td width="117">Vendor Name :</td>
    <td width="150"><script>document.write(self.opener.document.voucherInvoiceAllocation.vendor_name.value);</script></td>
  </tr>
  <tr valign="top">
    <td width="87"> Invoice #:</td>
    <td width="136"><script>document.write(self.opener.document.voucherInvoiceAllocation.invoice_no.value);</script></td>
    <td width="150">Internal Acct :</td>
    <td width="150"><script>document.write(self.opener.document.voucherInvoiceAllocation.internalAccount.value);</script></td>
  </tr>
</table>
  </td>
</tr>

<tr>
	<td>
 	<table cellspacing="2" id=AgentTable cellpadding="2" border="1">
        <tr valign="top">
          <td width="10%"><span class=rqrd>*</span>EmpID</td>
          <td width="20%"><span class=rqrd>*</span>Name</td>
          <td width="30%"><span class=rqrd>*</span>Lab Cat</td>
          <td width="10%">Lab Desc</td>
          <td width="10%"><span class=rqrd>*</span>Hours</td>          
          <td width="10%"><span class=rqrd>*</span>Trans Amt</td>
          <td width="10%"%">Notes</td>
		</tr>
		
		<tr valign="top">
<!-- aght-->         
          <td width="10%" align=center><input name="empId1" id="empId1" class="inps" size="8"  onfocus="setCount(1);this.style.backgroundColor='SkyBlue';setEmpId(this);"  onBlur="fillOther(this,1);this.style.backgroundColor='White';empIdBlur(this,1);" ></td>
          <td width="20%" align=center><input  name="empName1" id="empName1" class="inps" size="16"  onfocus="setCount(1);this.style.backgroundColor='SkyBlue';setEmpName(this);"  onBlur="fillOther(this,1);this.style.backgroundColor='White';" ></td>
   		  <td width="30%" align=center><input name="agentId1" id="agentId1" type="hidden" value="III">
   		  <input name="labCat1" id="labCat1" class="inps" onfocus="setCount(1);this.style.backgroundColor='SkyBlue';setLabCat(this);" onBlur="fillOther(this,1);this.style.backgroundColor='White';" size="5" maxlength="5"></td>
          
          <td width="10%" align=center><input name="labDesc1" id="labDesc1"   onfocus="setCount(1);this.style.backgroundColor='SkyBlue';setLabDesc(this);" onBlur="fillOther(this,1);this.style.backgroundColor='White';" class="inps" size="12"></td>
          
          <td width="10%" align="center"><input name="hours1" id="hours1"  onfocus="setCount(1);this.style.backgroundColor='SkyBlue';"   class="inps" size="2"  onBlur="this.style.backgroundColor='White';" ></td>
          <td width="10%" align=center><input style='text-align : right;'  onfocus="setCount(1);this.style.backgroundColor='SkyBlue';"  name="agent_amount1" id="agent_amount1" onBlur="agentAmtChange(this);agentAmtBlur(this,1);transAmountBlur(this,1);"   class="inps" size="18" maxlength="18"></td>
         
          <td width="10%" align=center>
         	<IMG id="cmt1b" style="align: right;" height=24 alt="" onclick="commentWindow('Comment.html','cmt1');"  onselect="commentWindow("Comment.html","cmt1");" src="/docorganiz5/images/notes.png" width=20 border=1>
					<input   type="hidden" name="cmt1h" id="cmt1h"></input>    	
    			<input type="hidden" name="cmt1" id="cmt1"></input> 
  

          </td>		 
         </tr>
          		
          		
	      <tr>
	      	<td align=center>
	      		<label><p wrap="true">Line Item Amt:</p></label>
	      	</td>

	      	<td colspan=1 valign="top"><script>document.write(self.opener.document.voucherInvoiceAllocation.lineItemAmount.value);</script>
	      	</td>
	  			
	  			<td valign="top" align=center>
	        		<label><p wrap="true">Residual Allocation :</p></label>
	        </td>
	        
	        <td  colspan=1 valign="top">
	        	<span id=residualAmount></span>
	        </td>
	        
	      	<td align=center><label><p wrap="true">Trans Total :</p></label></td>
	      	<td valign="top"  align=right><span id=agentTotal></span> <input type=hidden name="agentTot" value="0"></td>
	        
	      </tr>
	      
	      
	      <tr><td >
		   	 <button name='addAgentChg' onfocus=this.style.backgroundColor='SkyBlue'; onBlur=this.style.backgroundColor='white'; id='addAgentChg' buttonlabel='addAgentChg' onclick=insertAgentRow() ><p wrap='true'>New Line</p></button>
		    	<input type=hidden name=agnCtr id=agnCtr value=1>
		  	</td>
		  	<td colspan=6 align=center><button  onfocus=this.style.backgroundColor='SkyBlue'; onBlur=this.style.backgroundColor='white';  name=saveDone id=saveDone onclick=save()>Save & Return</button>
	
		  	<button name=return id=return  onfocus=this.style.backgroundColor='SkyBlue'; onBlur=this.style.backgroundColor='white';  onclick=cancelAndReturn();>Return</button></td></tr>

	</table>
	</td>
  </tr>
</table>
		<input type=hidden name=currentAgentCount id=currentAgentCount value=1>	
		  <input type=hidden name=comm id=comm>
</form>

</body>
</html>
