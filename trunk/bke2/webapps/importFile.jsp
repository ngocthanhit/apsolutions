<%@ page language="java" import="com.intuit.quickbase.util.*,com.bke2.util.*,au.com.bytecode.opencsv.CSVReader,com.infomata.data.*" %><%@ page buffer="256kb"%>  <%@ page import="java.util.*"%><%@ page import="java.text.SimpleDateFormat"%>      <%@ page import="java.lang.reflect.Array"%>  <%@ page import="org.w3c.dom.Document"%>  <%@ page import="org.xml.sax.InputSource"%>  <%@ page import="org.w3c.dom.Element"%>  <%@ page import="org.w3c.dom.NodeList"%>  <%@ page import="org.w3c.dom.Node"%> <%@ page import="java.io.*"%>  <FORM  ENCTYPE="multipart/form-data" ACTION="importFile.jsp" METHOD=POST>		<br><br><br>	  <center><table border="2" >                    <tr><center><td colspan="2"><p align="center"><B>Upload File Into QuickBase</B><center></td></tr>                    <tr><td><b>Choose the TAB delimitted file to Upload:</b></td>                    <td><INPUT NAME="F1" TYPE="file"></td></tr>					<tr><td colspan="2"><p align="right"><INPUT TYPE="submit" VALUE="Submit File" ></p></td></tr>             <table>     </center>           </FORM><% /*     if (request.getMethod().equalsIgnoreCase("POST")) {	 	 				 String primaryKey ="";		 String primaryKey1 ="";		 ServletContext context = this.getServletContext() ;  		String invoiceTableId = context.getInitParameter( "invoiceTableId" ); 		 String line = null;		 String vendor = null;		 String companyName = null;		 String accountNo = null;		 String type = null;		 String creditLimit = null;		 String vendorIsActive = null;		 String clientID = null;		 String vendorID = null;		 ArrayList list = new ArrayList();				 String u = "ramyajayaraman1@gmail.com";		 String p = "Archana.v1";		 String strURL = "https://docorganiz.quickbase.com/db/";		 HashMap infoHash = new  HashMap();		 HashMap infoHash1 = new  HashMap();		 QuickBaseClient qdb12 = new QuickBaseClient(u ,p , strURL);		 //File file = new File("c:/Archana/QuickBase.CSV");		 			 		 //Header configurations.		 		 		 // Line Item Info		 		 		 						 String checkHeader2 = "";		 ServletContext context = this.getServletContext() ;  					 String invoiceNumber = "";		 String file = "";		 String saveFile = "";		 String contentType = request.getContentType();		 		 			 		 		 		 if ((contentType != null) && (contentType.indexOf("multipart/form-data") >= 0))		  { 		      DataInputStream in = new DataInputStream(request.getInputStream());			  //we are taking the length of Content type data			  int formDataLength = request.getContentLength();			  byte dataBytes[] = new byte[formDataLength];			  int byteRead = 0;			  int totalBytesRead = 0;			  			  //this loop converting the uploaded file into byte code			   while (totalBytesRead < formDataLength)			   {			     byteRead = in.read(dataBytes, totalBytesRead, formDataLength);			     totalBytesRead += byteRead;			   }			   file = new String(dataBytes);			   			   //for saving the file name			   saveFile = file.substring(file.indexOf("filename=\"") + 10);			   System.out.println("**file***"+saveFile);			   			   			   saveFile = saveFile.substring(0, saveFile.indexOf("\n"));			   saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1,saveFile.indexOf("\""));			   int lastIndex = contentType.lastIndexOf("=");			   String boundary = contentType.substring(lastIndex + 1,contentType.length());			   int pos;			   System.out.println("boun"+boundary);			   //extracting the index of file 			   pos = file.indexOf("filename=\"");			   pos = file.indexOf("\n", pos) + 1;			   pos = file.indexOf("\n", pos) + 1;			   pos = file.indexOf("\n", pos) + 1;			   int boundaryLocation = file.indexOf(boundary, pos) - 4;			   int startPos = ((file.substring(0, pos)).getBytes()).length;			   int endPos = ((file.substring(0, boundaryLocation)).getBytes()).length;			   // creating a new file with the same name and writing the content in new file			   FileOutputStream fileOut = new FileOutputStream(saveFile);			   fileOut.write(dataBytes, startPos, (endPos - startPos));			   fileOut.flush();			   fileOut.close();			 }			   			   		 System.out.println("file"+saveFile);		 BufferedReader bufRdr  = new BufferedReader(new FileReader(saveFile));		 while((line = bufRdr.readLine()) != null)         {               StringTokenizer st = new StringTokenizer(line,delimiter);           while (st.hasMoreTokens())           {			  list.add(st.nextToken());			  //System.out.println("listAdded");           }		 		 }										//saving the file values in quick base			System.out.println("size"+list.size());		try{		    for(int i=0 ;i<list.size();i++)		    {		  	    if(billField1.equalsIgnoreCase((String)list.get(i)))			    {			      i=i+noOfBillHeaders;			      //System.out.println("inside list"+list.get(i));			      System.out.println("count"+i);			      //infoHash.put(billColId1,list.get(i++));			      System.out.println("Vendor"+list.get(i++));			      //infoHash.put(billColId2,list.get(i++));			      System.out.println("Acc No"+list.get(i++));			      //infoHash.put(billColId3,list.get(i++));			      System.out.println("Terms"+list.get(i++));				  invoiceNumber = (String)list.get(i++);			      infoHash.put(billColId4,invoiceNumber);			      //System.out.println("Inv #"+list.get(i++));			      infoHash.put(billColId5,list.get(i++));			      //infoHash.put(billColId6,list.get(i++));			      System.out.println("App Amt"+list.get(i++));			      //infoHash.put(billColId7,list.get(i++));			      System.out.println("Count APP"+list.get(i++));			      infoHash.put(billColId8,list.get(i));			//      primaryKey = qdb12.addRecord(invoiceTableId, infoHash);			      System.out.println("primary key"+primaryKey);				  System.out.println("****i********"+i);										 			    }			    else 			    {				 			      if(lineField1.equalsIgnoreCase((String)list.get(i)))			      {			         System.out.println("Inside Header 2");			         i=i+(NoOfLineHeaders-1);			      			      }				      else			      {			         //infoHash1.put(lineAccountNumber,list.get(i++));					 System.out.println("Line Acc Num"+list.get(i++));			         //infoHash1.put(lineColId1,list.get(i++));					 System.out.println("Line Acc Name"+list.get(i++));			         //infoHash1.put(lineColId2,list.get(i++));			         infoHash1.put(lineColId3,list.get(i++));					 infoHash1.put(lineColId4,list.get(i));					 					 //inserting the line header ID					 infoHash1.put(lineHeaderID,primaryKey);					 			         System.out.println("count after line items"+i);					 //    primaryKey1 = qdb12.addRecord(lineItemTableId, infoHash1);			         System.out.println("primary key line item"+primaryKey1);				  			       }			     }			  }			}catch(Exception iBizQBException)			 {			   System.out.println("iBizQBException "+iBizQBException.getMessage());			 }		  		  }*/	 		 	 	 	 	 %>